{"uid":"cba86545a8b32785","name":"test_flow_tracking_stats","historyId":"pytest:traffic-properties.test_flow_tracking#test_flow_tracking_stats","time":{"start":1756228444993,"stop":1756228495074,"duration":50081},"status":"failed","statusMessage":"snappi_ixnetwork.exceptions.SnappiIxnException:   File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/snappi_ixnetwork/snappi_api.py\", line 473, in set_control_state\n    self.traffic_item.transmit(request_payload)\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/snappi_ixnetwork/trafficitem.py\", line 1531, in transmit\n    self._api._traffic.Apply()\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/testplatform/sessions/ixnetwork/traffic/traffic.py\", line 1415, in Apply\n    return self._execute(\"apply\", payload=payload, response_object=None)\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/base.py\", line 452, in _execute\n    response = self._connection._execute(url, payload)\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 293, in _execute\n    return self._send_recv(\"POST\", url, payload)\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 576, in _send_recv\n    return self._poll()\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 644, in _poll\n    return self._process_response_status_code(\n  File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 480, in _process_response_status_code\n    raise BadRequestError(message, response.status_code)\n  Error in L2/L3 Traffic Apply","statusTrace":"self = <snappi_ixnetwork.snappi_api.Api object at 0x7f9f2447d990>\npayload = <snappi.snappi.ControlState object at 0x7f9f20781800>\n\n    def set_control_state(self, payload):\n        try:\n            control_option = payload.choice\n            control_obj = getattr(payload, control_option)\n            control_choice = control_obj.get(\"choice\")\n            request_payload = getattr(control_obj, control_choice)\n            self._connect()\n            event_names = []\n            event_state = None\n            event_type = control_choice\n            EventInfo = namedtuple(\n                \"EventInfo\", [\"event_type\", \"event_state\", \"event_names\"]\n            )\n            if control_option == \"port\":\n                if control_choice == \"capture\":\n                    self.capture.set_capture_state(request_payload)\n                elif control_choice == \"link\":\n                    self._TRIGGERED_EVENT = \"link\"\n                    if request_payload.port_names is not None:\n                        event_names = request_payload.port_names\n                        event_state = request_payload.state\n                    self.vport.set_link_state(request_payload)\n            elif control_option == \"protocol\":\n                if control_choice == \"all\":\n                    self.ngpf.set_protocol_state(request_payload)\n                elif control_choice == \"route\":\n                    event_state = request_payload.state\n                    with Timer(self, \"Setting route state\"):\n                        event_names = self.ngpf.set_route_state(\n                            request_payload\n                        )\n                elif control_choice == \"lacp\":\n                    self.ngpf.set_device_state(request_payload)\n            elif control_option == \"traffic\":\n>               self.traffic_item.transmit(request_payload)\n\nsnappi_ixnetwork/snappi_api.py:473: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsnappi_ixnetwork/trafficitem.py:1531: in transmit\n    self._api._traffic.Apply()\n.env/lib/python3.10/site-packages/ixnetwork_restpy/testplatform/sessions/ixnetwork/traffic/traffic.py:1415: in Apply\n    return self._execute(\"apply\", payload=payload, response_object=None)\n.env/lib/python3.10/site-packages/ixnetwork_restpy/base.py:452: in _execute\n    response = self._connection._execute(url, payload)\n.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py:293: in _execute\n    return self._send_recv(\"POST\", url, payload)\n.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py:576: in _send_recv\n    return self._poll()\n.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py:644: in _poll\n    return self._process_response_status_code(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <ixnetwork_restpy.connection.Connection object at 0x7f9f21b4d4e0>\nurl = None\nheaders = {'Connection': 'keep-alive', 'Content-Type': 'application/json', 'User-Agent': 'ixnetwork-restpy', 'X-Api-Key': '7ab454f63f15459cb958d22bcf9324e9', ...}\nresponse = <Response [400]>\nasync_status = {'executionTimeMs': 2926.0, 'id': '', 'message': None, 'progress': 100, ...}\n\n    def _process_response_status_code(self, url, headers, response, async_status=False):\n        errors = []\n        # add the initial error\n        if async_status is True:\n            async_status = response.json()\n            if (\n                \"message\" in async_status\n                and async_status[\"message\"] is not None\n                and \"API CONTENTION\" in async_status[\"message\"]\n            ):\n                response.status_code = 409\n            else:\n                response.status_code = 400\n            error = \"\"\n            if \"message\" in async_status and async_status[\"message\"] is not None:\n                error += \" \" + async_status[\"message\"]\n            if \"result\" in async_status and async_status[\"result\"] is not None:\n                error += \" \" + async_status[\"result\"]\n            errors.append(error)\n        else:\n            try:\n                for error in response.json()[\"errors\"]:\n                    errors.append(error[\"detail\"])\n            except:\n                errors.append(response.text)\n        # add any /globals/appErrors/error items\n        try:\n            preamble = url[\n                0 : url.find(\"/\", url.find(\"/sessions/\") + len(\"/sessions/\"))\n            ]\n            url = preamble + \"/ixnetwork/globals/appErrors/error\"\n            self._print_request(\"GET\", url)\n            error_response = self._session.request(\n                \"GET\",\n                url,\n                headers=headers,\n                verify=self._verify_cert,\n                allow_redirects=False,\n            )\n            server_info = \"\\tCurrent Server Errors/Warnings:\"\n            for error in error_response.json():\n                if error[\"errorLevel\"] in [\"kError\", \"kWarning\"]:\n                    if server_info is not None:\n                        errors.append(server_info)\n                        server_info = None\n                    errors.append(\n                        \"\\t%s [%s] [%s] %s\"\n                        % (\n                            error[\"lastModified\"],\n                            error[\"errorLevel\"][1:].upper(),\n                            error[\"name\"],\n                            error[\"description\"],\n                        )\n                    )\n        except:\n            pass\n        # raise the appropriate error\n        message = \"\\n\".join(errors)\n        logging.getLogger(__name__).debug(message)\n        if response.status_code == 400:\n>           raise BadRequestError(message, response.status_code)\nE           ixnetwork_restpy.errors.BadRequestError:  Error in L2/L3 Traffic Apply\n\n.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py:480: BadRequestError\n\nDuring handling of the above exception, another exception occurred:\n\napi = <snappi_ixnetwork.snappi_api.Api object at 0x7f9f2447d990>\nutils = <module 'utils' from '/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/tests/utils/__init__.py'>\n\n    def test_flow_tracking_stats(api, utils):\n        config = api.config()\n        api._enable_flow_tracking(True)\n        # ports\n        p1, p2, p3, p4 = (\n            config.ports.port(name=\"p1\", location=utils.settings.ports[0])\n            .port(name=\"p2\", location=utils.settings.ports[1])\n            .port(name=\"p3\", location=utils.settings.ports[2])\n            .port(name=\"p4\", location=utils.settings.ports[3])\n        )\n        layer1 = config.layer1.layer1()[-1]\n        layer1.port_names = [port.name for port in config.ports]\n        layer1.speed = \"speed_100_gbps\"\n        layer1.media = \"copper\"\n        layer1.name = \"test\"\n    \n        config.options.port_options.location_preemption = True\n    \n        d1, d2, d3, d4 = (\n            config.devices.device(name=\"Device1\")\n            .device(name=\"Device2\")\n            .device(name=\"Device3\")\n            .device(name=\"Device4\")\n        )\n        eth1, eth2 = (\n            d1.ethernets.add(),\n            d2.ethernets.add(),\n        )\n    \n        eth3, eth4 = (\n            d3.ethernets.add(),\n            d4.ethernets.add(),\n        )\n        eth1.connection.port_name, eth2.connection.port_name = p1.name, p2.name\n        eth3.connection.port_name, eth4.connection.port_name = p3.name, p4.name\n    \n        # device1\n        eth1.name = \"Eth1\"\n        eth1.mac = \"00:02:00:00:00:11\"\n        ip1 = eth1.ipv4_addresses.add()\n        ip1.name = \"ip1\"\n        ip1.address = \"10.10.10.1\"\n        ip1.prefix = 32\n        ip1.gateway = \"10.10.10.2\"\n    \n        # device2\n        eth2.name = \"Eth2\"\n        eth2.mac = \"00:02:00:00:00:12\"\n        ip2 = eth2.ipv4_addresses.add()\n        ip2.name = \"ip2\"\n        ip2.address = \"10.10.10.2\"\n        ip2.prefix = 32\n        ip2.gateway = \"10.10.10.1\"\n    \n        # device3\n        eth3.name = \"Eth3\"\n        eth3.mac = \"00:02:00:00:00:13\"\n        ip3 = eth3.ipv4_addresses.add()\n        ip3.name = \"ip3\"\n        ip3.address = \"20.20.20.1\"\n        ip3.prefix = 32\n        ip3.gateway = \"20.20.20.2\"\n    \n        # device4\n        eth4.name = \"Eth4\"\n        eth4.mac = \"00:02:00:00:00:14\"\n        ipv4 = eth4.ipv4_addresses.add()\n        ipv4.name = \"ip4\"\n        ipv4.address = \"20.20.20.2\"\n        ipv4.prefix = 32\n        ipv4.gateway = \"20.20.20.1\"\n    \n        # traffic\n        config.flows.flow(name=\"Full Mesh Traffic\")\n        flow = config.flows[-1]\n        flow.metrics.enable = True\n        flow.metrics.loss = True\n        endpoints = [device.name for device in config.devices]\n        flow.tx_rx.device.tx_names = endpoints\n        flow.tx_rx.device.rx_names = endpoints\n        flow.packet.ethernet().ipv4().udp()\n        flow.packet[1]\n        flow.size.fixed = 128\n        flow.duration.fixed_packets.packets = 10000\n        flow.rate.percentage = 1\n        api.set_config(config)\n    \n        print(\"Starting all protocols ...\")\n        ps = api.control_state()\n        ps.choice = ps.PROTOCOL\n        ps.protocol.choice = ps.protocol.ALL\n        ps.protocol.all.state = ps.protocol.all.START\n        res = api.set_control_state(ps)\n        if len(res.warnings) > 0:\n            print(\"Warnings: {}\".format(res.warnings))\n        time.sleep(5)\n    \n        print(\"Start Traffic ...\")\n        # start traffic\n        control_state = api.control_state()\n        control_state.choice = control_state.TRAFFIC\n        control_state.traffic.choice = control_state.traffic.FLOW_TRANSMIT\n        control_state.traffic.flow_transmit.state = control_state.traffic.flow_transmit.START  # noqa\n>       res = api.set_control_state(control_state)\n\ntests/traffic-properties/test_flow_tracking.py:108: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <snappi_ixnetwork.snappi_api.Api object at 0x7f9f2447d990>\npayload = <snappi.snappi.ControlState object at 0x7f9f20781800>\n\n    def set_control_state(self, payload):\n        try:\n            control_option = payload.choice\n            control_obj = getattr(payload, control_option)\n            control_choice = control_obj.get(\"choice\")\n            request_payload = getattr(control_obj, control_choice)\n            self._connect()\n            event_names = []\n            event_state = None\n            event_type = control_choice\n            EventInfo = namedtuple(\n                \"EventInfo\", [\"event_type\", \"event_state\", \"event_names\"]\n            )\n            if control_option == \"port\":\n                if control_choice == \"capture\":\n                    self.capture.set_capture_state(request_payload)\n                elif control_choice == \"link\":\n                    self._TRIGGERED_EVENT = \"link\"\n                    if request_payload.port_names is not None:\n                        event_names = request_payload.port_names\n                        event_state = request_payload.state\n                    self.vport.set_link_state(request_payload)\n            elif control_option == \"protocol\":\n                if control_choice == \"all\":\n                    self.ngpf.set_protocol_state(request_payload)\n                elif control_choice == \"route\":\n                    event_state = request_payload.state\n                    with Timer(self, \"Setting route state\"):\n                        event_names = self.ngpf.set_route_state(\n                            request_payload\n                        )\n                elif control_choice == \"lacp\":\n                    self.ngpf.set_device_state(request_payload)\n            elif control_option == \"traffic\":\n                self.traffic_item.transmit(request_payload)\n            elif control_option is not None:\n                msg = \"{} is not a supported choice for metrics; \\\n                the supported choices are \\\n                ['port', 'protocol', traffic]\".format(\n                    control_option\n                )\n                raise SnappiIxnException(400, msg)\n            self._event_info = EventInfo(event_type, event_state, event_names)\n        except Exception as err:\n>           raise SnappiIxnException(err)\nE           snappi_ixnetwork.exceptions.SnappiIxnException:   File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/snappi_ixnetwork/snappi_api.py\", line 473, in set_control_state\nE               self.traffic_item.transmit(request_payload)\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/snappi_ixnetwork/trafficitem.py\", line 1531, in transmit\nE               self._api._traffic.Apply()\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/testplatform/sessions/ixnetwork/traffic/traffic.py\", line 1415, in Apply\nE               return self._execute(\"apply\", payload=payload, response_object=None)\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/base.py\", line 452, in _execute\nE               response = self._connection._execute(url, payload)\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 293, in _execute\nE               return self._send_recv(\"POST\", url, payload)\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 576, in _send_recv\nE               return self._poll()\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 644, in _poll\nE               return self._process_response_status_code(\nE             File \"/home/github-runner/actions-runner/_work/snappi-ixnetwork/snappi-ixnetwork/.env/lib/python3.10/site-packages/ixnetwork_restpy/connection.py\", line 480, in _process_response_status_code\nE               raise BadRequestError(message, response.status_code)\nE             Error in L2/L3 Traffic Apply\n\nsnappi_ixnetwork/snappi_api.py:483: SnappiIxnException","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"steps":[{"name":"--------------------------------- Captured Log ---------------------------------","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 p3 connectedLinkDown","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 p4 connectedLinkDown","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 /vport[1]/l1Config/novusTenGigLan kWarning invalidJsonPropertyValue Object reference not set to an instance of an object.","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 /vport[2]/l1Config/novusTenGigLan kWarning invalidJsonPropertyValue Object reference not set to an instance of an object.","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 /vport[3]/l1Config/novusTenGigLan kWarning invalidJsonPropertyValue Object reference not set to an instance of an object.","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"WARNING  root:snappi_api.py:1518 /vport[4]/l1Config/novusTenGigLan kWarning invalidJsonPropertyValue Object reference not set to an instance of an object.","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"DEBUG    ixnetwork_restpy.connection:connection.py:478  Error in L2/L3 Traffic Apply","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"--------------------------------- Captured Out ---------------------------------","time":{},"steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":9,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"resultFormat","value":"junit"},{"name":"suite","value":"pytest"},{"name":"host","value":"snappi-ixn-ci-novus10g"},{"name":"testClass","value":"traffic-properties.test_flow_tracking"},{"name":"package","value":"traffic-properties.test_flow_tracking"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":8,"broken":0,"skipped":0,"passed":62,"unknown":0,"total":70},"items":[{"uid":"84d9b81656c80869","status":"passed","time":{"start":1756153102547,"stop":1756153222545,"duration":119998}},{"uid":"26f62cd6d60a9593","status":"passed","time":{"start":1756145518681,"stop":1756145643975,"duration":125294}},{"uid":"6eecbdcbab85df7a","status":"passed","time":{"start":1756135659955,"stop":1756135794957,"duration":135002}},{"uid":"1d94a1a2c4ccd4c4","status":"passed","time":{"start":1756112750540,"stop":1756112858333,"duration":107793}},{"uid":"864673fd26c0f717","status":"passed","time":{"start":1756097345515,"stop":1756097436332,"duration":90817}},{"uid":"a32d66e1c900fcf4","status":"passed","time":{"start":1755853618770,"stop":1755853754901,"duration":136131}},{"uid":"d89f41ae1206f6ac","status":"passed","time":{"start":1755770830114,"stop":1755770932902,"duration":102788}},{"uid":"35f0d940edb7954e","status":"passed","time":{"start":1755605594608,"stop":1755605686013,"duration":91405}},{"uid":"25081d2031436ba5","status":"passed","time":{"start":1755598268759,"stop":1755598367666,"duration":98907}},{"uid":"bd5d45dea9dd65a4","status":"passed","time":{"start":1755590656281,"stop":1755590758011,"duration":101730}},{"uid":"42f0de44279b0919","status":"passed","time":{"start":1755582190551,"stop":1755582287779,"duration":97228}},{"uid":"7714dbdfe71cc965","status":"passed","time":{"start":1755172446673,"stop":1755172539296,"duration":92623}},{"uid":"54850d8312f35c32","status":"passed","time":{"start":1755152544019,"stop":1755152654615,"duration":110596}},{"uid":"ed5aca7f1fe81140","status":"passed","time":{"start":1754658965828,"stop":1754659059780,"duration":93952}},{"uid":"85d087b7bb75c1b6","status":"passed","time":{"start":1754630978584,"stop":1754631078003,"duration":99419}},{"uid":"64973c946eeeda41","status":"passed","time":{"start":1754558943969,"stop":1754559042308,"duration":98339}},{"uid":"bb6b137ad33cfbf5","status":"passed","time":{"start":1754546458930,"stop":1754546562236,"duration":103306}},{"uid":"7e61094f6ca7beb8","status":"passed","time":{"start":1754506043870,"stop":1754506138677,"duration":94807}},{"uid":"71d7a895d5ae1b7f","status":"passed","time":{"start":1754497549774,"stop":1754497639399,"duration":89625}},{"uid":"24163b62c6292ad1","status":"passed","time":{"start":1754464142327,"stop":1754464240810,"duration":98483}}]},"tags":[]},"source":"cba86545a8b32785.json","parameterValues":[]}